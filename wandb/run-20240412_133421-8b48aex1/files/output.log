04-12 13:34:22 imba: True
04-12 13:34:22 model_name: ACDANN
04-12 13:34:22 Domain: CWRU
04-12 13:34:22 source: CWRU_0
04-12 13:34:22 target: CWRU_1
04-12 13:34:22 data_dir: ./datasets
04-12 13:34:22 train_mode: single_source
04-12 13:34:22 cuda_device: 0
04-12 13:34:22 save_dir: ./ckpt/ACDANN/single_source
04-12 13:34:22 max_epoch: 50
04-12 13:34:22 batch_size: 64
04-12 13:34:22 num_workers: 0
04-12 13:34:22 signal_size: 2048
04-12 13:34:22 random_state: 2024
04-12 13:34:22 normlizetype: mean-std
04-12 13:34:22 opt: sgd
04-12 13:34:22 lr: 0.001
04-12 13:34:22 momentum: 0.9
04-12 13:34:22 betas: (0.9, 0.999)
04-12 13:34:22 weight_decay: 0.0005
04-12 13:34:22 lr_scheduler: stepLR
04-12 13:34:22 gamma: 0.2
04-12 13:34:22 steps: 10
04-12 13:34:22 tradeoff: ['exp', 'exp', 'exp']
04-12 13:34:22 dropout: 0.0
04-12 13:34:22 save: False
04-12 13:34:22 load_path: 
04-12 13:34:22 tsne: False
04-12 13:34:22 save_path: ./ckpt/ACDANN/single_source/[CWRU_0]To[CWRU_1]_0412-133422
04-12 13:34:22 Detect 4 classes: ['1normal', 'ball', 'inner', 'outer']
04-12 13:34:23 using 1 / 1 gpus
Training data length: 759
Testing data length: 380
Source Data Distribution:04-12 13:34:25 Source set CWRU_0 number of samples 1044.
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     261 |
| 1            |     261 |
| 2            |     261 |
| 3            |     261 |
| Dataset Size |    1044 |
+--------------+---------+

Training data length: 757
Testing data length: 379
Target Data Distribution:04-12 13:34:26 target training set number of samples 177.
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     174 |    87 |
| 1            |       1 |    87 |
| 2            |       1 |    87 |
| 3            |       1 |    87 |
| Dataset Size |     177 |   348 |
+--------------+---------+-------+

04-12 13:34:26 target validation set number of samples 348.
04-12 13:34:26 -----Epoch 1/50-----
04-12 13:34:26 current lr: [0.001, 0.001]
  0%|          | 0/2 [00:00<?, ?it/s]  0%|          | 0/2 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 95, in <module>
    trainer.train()
  File "/home/workspace/UDA_Bearing_Fault_Diagnosis/models/ACDANN.py", line 117, in train
    feat = self.grl(torch.concat((f_s, feat_tgt_), dim=0))
RuntimeError: Sizes of tensors must match except in dimension 0. Expected size 2560 but got size 10240 for tensor number 1 in the list.
