04-12 11:40:16 imba: True
04-12 11:40:16 model_name: DANN_correct
04-12 11:40:16 Domain: CWRU
04-12 11:40:16 source: CWRU_0
04-12 11:40:16 target: CWRU_1
04-12 11:40:16 data_dir: ./datasets
04-12 11:40:16 train_mode: single_source
04-12 11:40:16 cuda_device: 0
04-12 11:40:16 save_dir: ./ckpt/DANN_correct/single_source
04-12 11:40:16 max_epoch: 30
04-12 11:40:16 batch_size: 64
04-12 11:40:16 num_workers: 0
04-12 11:40:16 signal_size: 2048
04-12 11:40:16 random_state: 2
04-12 11:40:16 normlizetype: mean-std
04-12 11:40:16 opt: sgd
04-12 11:40:16 lr: 0.001
04-12 11:40:16 momentum: 0.9
04-12 11:40:16 betas: (0.9, 0.999)
04-12 11:40:16 weight_decay: 0.0005
04-12 11:40:16 lr_scheduler: stepLR
04-12 11:40:16 gamma: 0.2
04-12 11:40:16 steps: 10
04-12 11:40:16 tradeoff: ['exp', 'exp', 'exp']
04-12 11:40:16 dropout: 0.0
04-12 11:40:16 save: False
04-12 11:40:16 load_path: 
04-12 11:40:16 tsne: False
04-12 11:40:16 save_path: ./ckpt/DANN_correct/single_source/[CWRU_0]To[CWRU_1]_0412-114016
04-12 11:40:16 Detect 4 classes: ['1normal', 'ball', 'inner', 'outer']
04-12 11:40:17 using 1 / 1 gpus
Training data length: 759
Testing data length: 380
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     261 |
| 1            |     261 |
| 2            |     261 |
| 3            |     261 |
| Dataset Size |    1044 |
+--------------+---------+
04-12 11:40:19 Source set CWRU_0 number of samples 1044.
Training data length: 757
Testing data length: 379
04-12 11:40:20 target training set number of samples 177.
Target Data Distribution:
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     174 |    87 |
| 1            |       1 |    87 |
| 2            |       1 |    87 |
| 3            |       1 |    87 |
| Dataset Size |     177 |   348 |
+--------------+---------+-------+
04-12 11:40:20 target validation set number of samples 348.
04-12 11:40:20 -----Epoch 1/30-----
04-12 11:40:20 current lr: [0.001, 0.001]
  0%|          | 0/2 [00:00<?, ?it/s]tensor([[ 6.2562e-02,  1.8176e-01,  1.2614e-01,  3.5019e-02],
        [ 1.0525e-01,  2.4032e-01,  3.6050e-02,  1.3815e-01],
        [ 7.0703e-02,  2.2439e-01,  1.1515e-01,  8.6673e-02],
        [ 9.9154e-02,  5.9268e-02,  1.6327e-01,  3.6265e-02],
        [ 2.0741e-01,  1.1872e-01,  1.2423e-01, -1.5123e-02],
        [ 2.6225e-02,  1.9703e-01,  1.5861e-01,  1.8483e-01],
        [ 8.8093e-02,  1.1476e-01,  8.9676e-02,  7.6450e-02],
        [ 1.2387e-01,  1.8221e-01,  1.2571e-01,  1.0215e-01],
        [ 8.6126e-02,  3.6127e-01,  1.8023e-01,  2.2496e-01],
        [ 8.4077e-02,  1.7152e-01,  1.1908e-01,  3.6190e-02],
        [ 1.4068e-01,  2.1620e-01,  4.4039e-02, -1.5341e-02],
        [ 1.4895e-01,  2.8221e-01,  1.3574e-01,  1.9914e-01],
        [ 1.6494e-01,  1.8706e-01,  1.8469e-01,  9.1888e-02],
        [ 4.6843e-02,  2.2942e-01,  2.2813e-01,  1.3871e-01],
        [ 1.1270e-01,  2.9453e-01,  1.5608e-01,  8.2009e-02],
        [ 6.0691e-02,  2.2226e-01,  1.2533e-01,  1.2809e-01],
        [ 1.8874e-01,  1.0936e-01,  1.1469e-01,  1.0104e-01],
        [ 1.1735e-01,  2.3648e-01,  1.6519e-01,  1.0879e-01],
        [ 1.3125e-01,  9.5431e-02,  1.7544e-01,  6.5855e-02],
        [ 1.9090e-01,  1.5378e-01,  1.1985e-01,  2.5112e-02],
        [ 3.3401e-01,  2.3388e-01,  2.8095e-01,  1.6215e-01],
        [ 6.9818e-02,  2.2522e-01,  2.1888e-01,  1.7590e-01],
        [ 1.5287e-01,  1.7043e-01,  1.1290e-01,  9.6778e-02],
        [ 9.3157e-02,  2.3485e-01,  1.2782e-01,  9.3676e-02],
        [ 1.1193e-01,  3.5119e-01,  7.0415e-02,  1.7569e-01],
        [ 8.6705e-02,  2.0961e-01,  8.4347e-02,  9.0130e-02],
        [ 9.5441e-02,  1.0466e-01,  9.0617e-02,  5.2012e-02],
        [ 1.6336e-01,  2.0156e-01,  8.9511e-02,  9.1909e-02],
        [ 1.1031e-01,  1.9124e-01,  6.3578e-03,  2.8174e-01],
        [ 1.3418e-01,  2.4897e-01,  2.0578e-01,  9.6460e-02],
        [ 1.3638e-01,  1.1974e-01,  2.2342e-01,  9.9070e-02],
        [ 8.5438e-02,  3.0709e-01,  1.4705e-01,  1.6724e-01],
        [ 1.0039e-01,  1.7905e-01,  9.7345e-02,  9.3439e-02],
        [ 5.2741e-02,  2.1369e-01,  1.2528e-01,  3.3647e-02],
        [ 8.3150e-02,  9.9836e-02,  1.5661e-01,  5.4996e-02],
        [ 9.9479e-02,  1.8112e-01,  1.6938e-01,  8.5137e-02],
        [ 1.5094e-01,  1.6267e-01,  1.5827e-01,  1.2466e-01],
        [ 1.2963e-01,  2.1101e-01,  6.0561e-02,  8.5862e-02],
        [ 1.4388e-01,  2.1236e-01,  1.8265e-01,  2.1460e-01],
        [ 7.3389e-02,  3.5928e-01,  2.1975e-02,  6.9562e-02],
        [ 8.9832e-02,  2.4723e-01,  2.7861e-01,  1.5265e-01],
        [ 7.2888e-02,  1.8810e-01,  1.5925e-01,  8.2417e-02],
        [ 1.2407e-01,  1.5580e-01,  1.2769e-01,  1.5628e-01],
        [ 6.5646e-02,  2.1752e-01,  1.1061e-01,  9.8920e-02],
        [ 1.0109e-01,  4.7676e-01,  1.8248e-01,  1.0449e-01],
        [ 9.2205e-02,  1.6950e-01,  1.4454e-01,  1.8263e-01],
        [ 1.3670e-01,  1.7466e-01,  5.2647e-02,  7.7545e-02],
        [ 5.1322e-02,  1.8738e-01,  7.2346e-02,  4.9399e-02],
        [ 1.3633e-01,  1.6671e-01,  8.6596e-02,  9.2188e-02],
        [ 9.2288e-02,  1.6752e-01,  2.0361e-01,  7.1407e-02],
        [ 2.3306e-01,  9.7227e-02,  1.1642e-01,  6.5542e-02],
        [ 6.7517e-02,  1.5957e-01,  1.4356e-01,  3.7547e-04],
        [ 1.6191e-01,  2.1219e-01,  8.5456e-02,  9.9059e-02],
        [ 1.2467e-01,  2.1345e-01,  1.6019e-01,  1.5263e-01],
        [ 3.4526e-02,  1.8034e-01,  1.5249e-01,  6.5070e-02],
        [ 1.5956e-01,  1.4141e-01,  8.3374e-02,  8.3207e-03],
        [ 5.6790e-02,  1.3890e-01,  2.0296e-01,  1.2278e-01],
        [ 1.2709e-01,  1.3675e-01,  1.4978e-01,  1.4692e-01],
        [ 1.7295e-01,  2.3682e-01,  1.1598e-01,  1.0047e-01],
        [ 1.0519e-01,  4.0463e-01,  9.5421e-02,  5.2995e-02],
        [ 1.2797e-01,  1.8971e-01,  1.2761e-01,  1.3591e-01],
        [ 3.1210e-02,  1.6661e-01,  2.2466e-01,  1.4826e-01],
        [ 1.0502e-01,  9.7481e-02,  2.0291e-01,  7.9181e-02],
        [ 2.2401e-01,  3.3086e-01,  1.5637e-01,  1.4115e-01]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([1, 1, 1, 0, 1, 3, 3, 3, 2, 0, 2, 3, 0, 3, 1, 1, 0, 3, 0, 2, 2, 2, 1, 1,
        2, 1, 2, 0, 3, 2, 0, 2, 1, 3, 0, 0, 0, 1, 2, 2, 2, 0, 0, 1, 3, 3, 3, 1,
        0, 2, 2, 1, 1, 3, 0, 0, 0, 3, 2, 2, 0, 3, 0, 3], device='cuda:0')
tensor([[ 0.0054,  0.2059,  0.2089,  0.3126],
        [ 0.0789,  0.1712,  0.1205,  0.0728],
        [ 0.0556,  0.2042,  0.2438,  0.1106],
        [ 0.1338,  0.1261,  0.0886,  0.0285],
        [ 0.0485,  0.1858,  0.2176,  0.0755],
        [ 0.1373,  0.1292,  0.1425,  0.1196],
        [ 0.1131,  0.2179,  0.2187,  0.1460],
        [ 0.0373,  0.1369,  0.1659,  0.1379],
        [ 0.1627,  0.1586,  0.1346,  0.0908],
        [ 0.0935,  0.0095,  0.2338,  0.1778],
        [ 0.0770,  0.2731,  0.2395,  0.1521],
        [ 0.2333,  0.1566,  0.1998, -0.0214],
        [ 0.1355,  0.2229,  0.1071,  0.1688],
        [ 0.0932,  0.2057,  0.1133,  0.0368],
        [ 0.1108,  0.1327,  0.1252,  0.0362],
        [ 0.0668,  0.1820,  0.1007,  0.1414],
        [ 0.1158,  0.2988,  0.1891,  0.2539],
        [ 0.1647,  0.1164,  0.1812,  0.0008],
        [ 0.1635,  0.4208,  0.0758,  0.2401],
        [ 0.0799,  0.1769,  0.3418,  0.1392],
        [ 0.0711,  0.0972,  0.1666,  0.1199],
        [ 0.1353,  0.1089,  0.1492,  0.0934],
        [ 0.1016,  0.2185,  0.1936,  0.2258],
        [ 0.0741,  0.0776,  0.2575,  0.1705],
        [ 0.1795,  0.1270,  0.1637,  0.1055],
        [ 0.1556,  0.1196,  0.1382,  0.1135],
        [ 0.0906,  0.1205,  0.0111,  0.0918],
        [ 0.0592,  0.1938,  0.1772,  0.2355],
        [ 0.1459,  0.1374,  0.1681,  0.1169],
        [ 0.0696,  0.2305,  0.1641,  0.1019],
        [ 0.0664,  0.2506,  0.2635,  0.0940],
        [ 0.1362,  0.1689,  0.1204,  0.1290],
        [ 0.0925,  0.1444,  0.1009,  0.1945],
        [ 0.1729,  0.1835,  0.1856,  0.1104],
        [ 0.1804,  0.2878,  0.1691,  0.0548],
        [ 0.1951,  0.1322,  0.1600,  0.1235],
        [ 0.1442,  0.0598,  0.1603,  0.1246],
        [ 0.0836,  0.2385,  0.1917, -0.0153],
        [ 0.4068,  0.2228,  0.2075,  0.2611],
        [ 0.1703,  0.2271,  0.1604,  0.0253],
        [ 0.1811,  0.2054,  0.1167,  0.1024],
        [ 0.0635,  0.1493,  0.1628, -0.0895],
        [ 0.0727,  0.1538,  0.1679,  0.0970],
        [ 0.1398,  0.1898,  0.1518,  0.1281],
        [ 0.1110,  0.2316,  0.1497,  0.1771],
        [ 0.0457,  0.2135,  0.1670,  0.1434],
        [ 0.1804,  0.2493,  0.0845,  0.0512],
        [ 0.0887,  0.1172,  0.0984,  0.0486],
        [ 0.0271,  0.1457,  0.1066,  0.0777],
        [ 0.1185,  0.1426,  0.1811,  0.0412],
        [ 0.2033,  0.1671,  0.0890,  0.0470],
        [ 0.0615,  0.2293,  0.1089,  0.1233],
        [ 0.2417,  0.1426,  0.0346,  0.0255],
        [ 0.2552,  0.2222,  0.1207, -0.0054],
        [ 0.1328,  0.0878,  0.1779,  0.0716],
        [ 0.1574,  0.1587,  0.0992,  0.0335],
        [ 0.1192,  0.1564,  0.1287,  0.1210],
        [ 0.0788,  0.3068,  0.1932,  0.0815],
        [ 0.1017,  0.1383,  0.1638,  0.0864],
        [ 0.1654,  0.0573,  0.1250,  0.1310],
        [ 0.0334,  0.1273,  0.2194,  0.1304],
        [ 0.0684,  0.2275,  0.0760,  0.1201],
        [ 0.0836,  0.2390,  0.1676,  0.2266],
        [ 0.0930,  0.2417,  0.1545,  0.0488]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([2, 0, 3, 1, 3, 0, 1, 1, 2, 3, 3, 1, 2, 2, 1, 1, 3, 2, 3, 3, 0, 0, 3, 3,
        0, 3, 2, 3, 0, 1, 3, 3, 3, 0, 3, 1, 0, 1, 2, 1, 0, 1, 1, 0, 1, 1, 2, 0,
        1, 2, 2, 3, 2, 2, 0, 1, 0, 1, 3, 0, 3, 1, 2, 2], device='cuda:0')
100%|##########| 2/2 [00:00<00:00, 16.95it/s]100%|##########| 2/2 [00:00<00:00, 16.91it/s]
04-12 11:40:20 Train-Loss Source Classifier: 1.3766
04-12 11:40:20 Train-Loss Discriminator: 0.6748
04-12 11:40:20 Train-Acc Source Data: 0.2969
04-12 11:40:20 Train-Acc Discriminator: 50.0000
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 162.73it/s]
04-12 11:40:20 Val-Acc Target Data: 0.2719
04-12 11:40:20 The best model epoch 1, val-acc 0.2719
04-12 11:40:20 -----Epoch 2/30-----
04-12 11:40:20 current lr: [0.001, 0.001]
  0%|          | 0/2 [00:00<?, ?it/s]tensor([[ 0.0083,  0.0839,  0.3912,  0.1237],
        [ 0.0808,  0.0655,  0.1632,  0.0791],
        [ 0.1593,  0.1072,  0.1008,  0.1480],
        [ 0.0789,  0.1488,  0.1514,  0.2189],
        [ 0.0357,  0.1133,  0.1509,  0.0745],
        [ 0.0066,  0.1332,  0.1324,  0.1164],
        [ 0.0462,  0.2068,  0.0574,  0.1506],
        [ 0.0902,  0.2088,  0.2427,  0.2528],
        [ 0.1631,  0.1494,  0.2057,  0.1368],
        [ 0.1391,  0.1068,  0.1611,  0.1361],
        [ 0.0721,  0.0769,  0.1619,  0.2981],
        [ 0.0941,  0.1817,  0.0958,  0.1759],
        [ 0.0797,  0.1829,  0.1929,  0.2042],
        [ 0.0696,  0.2111,  0.1396,  0.1808],
        [ 0.0658,  0.3323,  0.2214,  0.3136],
        [-0.1088,  0.2593,  0.2575,  0.1382],
        [ 0.1140,  0.1607,  0.1509,  0.0526],
        [ 0.0208,  0.1642,  0.2122,  0.2094],
        [ 0.0991,  0.1442,  0.1883,  0.1825],
        [ 0.0895,  0.0680,  0.2226,  0.1336],
        [ 0.0781,  0.0905,  0.0838,  0.1139],
        [ 0.0156,  0.1992,  0.0899,  0.1369],
        [ 0.0936,  0.1688,  0.1385,  0.2224],
        [ 0.1696,  0.1622,  0.0310,  0.1098],
        [ 0.0786,  0.2353,  0.1092,  0.1300],
        [ 0.0594,  0.0822,  0.2243, -0.0283],
        [-0.0445,  0.1359,  0.1528,  0.0878],
        [-0.0320,  0.1525,  0.1656,  0.2481],
        [ 0.1311,  0.1268,  0.2237,  0.1239],
        [ 0.0811,  0.1608,  0.2279,  0.1654],
        [-0.0831,  0.1650,  0.1054,  0.2309],
        [ 0.1177,  0.0853,  0.3137,  0.1234],
        [ 0.1936,  0.3320,  0.0158,  0.0122],
        [ 0.0779,  0.0646,  0.2165,  0.1883],
        [ 0.1323,  0.1015,  0.2261,  0.0939],
        [ 0.0935,  0.1653,  0.0989,  0.1837],
        [ 0.1187,  0.0549,  0.1490,  0.1214],
        [ 0.0811,  0.0979,  0.2411,  0.1832],
        [ 0.0689,  0.2216,  0.0694,  0.1175],
        [ 0.1872,  0.1329,  0.1810,  0.1110],
        [ 0.0942,  0.1649,  0.1099,  0.0604],
        [ 0.0736,  0.2017,  0.1539,  0.2529],
        [ 0.0943,  0.1108,  0.1257,  0.0748],
        [ 0.0426,  0.1531,  0.1600,  0.1871],
        [ 0.1045,  0.1536,  0.1504,  0.0747],
        [ 0.0952,  0.1070,  0.0800,  0.1234],
        [-0.0030,  0.2260,  0.1042,  0.2038],
        [ 0.1370,  0.2384,  0.0750,  0.0644],
        [ 0.0483,  0.1058,  0.1508,  0.1467],
        [ 0.0503,  0.0824,  0.1898,  0.0630],
        [ 0.1195,  0.1309,  0.1453,  0.1347],
        [ 0.1070,  0.1601,  0.1077,  0.0868],
        [ 0.0640,  0.1472,  0.1166,  0.2773],
        [ 0.1670,  0.1221,  0.1546,  0.0940],
        [ 0.0642,  0.0761,  0.1594,  0.1165],
        [ 0.0290,  0.1435,  0.0824,  0.0312],
        [ 0.0995,  0.1932,  0.1090,  0.1493],
        [ 0.0510,  0.2136,  0.1499,  0.1568],
        [ 0.1045,  0.2023,  0.1499,  0.1524],
        [ 0.0777,  0.0968,  0.1322,  0.1326],
        [ 0.0968,  0.0622,  0.1904,  0.0927],
        [ 0.0494,  0.1424,  0.1400,  0.2184],
        [ 0.1364,  0.1354,  0.2065,  0.2208],
        [ 0.0981,  0.1361,  0.1078,  0.0922]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([2, 1, 0, 2, 1, 1, 1, 3, 0, 0, 2, 1, 0, 2, 2, 3, 0, 2, 2, 0, 2, 1, 2, 2,
        1, 1, 3, 3, 1, 3, 3, 3, 1, 0, 0, 1, 0, 3, 2, 1, 1, 2, 0, 2, 0, 2, 3, 2,
        0, 0, 1, 1, 2, 0, 0, 1, 1, 1, 2, 0, 0, 3, 1, 1], device='cuda:0')
tensor([[ 0.1807,  0.0949,  0.2665,  0.0816],
        [ 0.0437,  0.1971,  0.2066,  0.2687],
        [ 0.0242,  0.1659,  0.1948,  0.2634],
        [ 0.0064,  0.2082,  0.1286,  0.0910],
        [ 0.0022,  0.2237,  0.1209,  0.1416],
        [ 0.1338,  0.1519,  0.1564,  0.1108],
        [ 0.0624,  0.2273,  0.0934,  0.1994],
        [ 0.0943,  0.2573,  0.1488,  0.0832],
        [-0.0481,  0.1872,  0.1518,  0.2642],
        [ 0.0753,  0.1282,  0.2401,  0.2240],
        [ 0.1205,  0.2346,  0.3353,  0.2694],
        [ 0.1355,  0.0725,  0.1141,  0.1985],
        [ 0.1328,  0.0482,  0.1827,  0.1210],
        [-0.0316,  0.1567,  0.0900,  0.1007],
        [ 0.0433,  0.1743,  0.1674,  0.1698],
        [ 0.0405,  0.0976,  0.2434,  0.0976],
        [ 0.1028,  0.0898,  0.2424,  0.1194],
        [ 0.1629,  0.0752,  0.1572,  0.1810],
        [ 0.1038,  0.0680,  0.1468,  0.1050],
        [ 0.1117,  0.0618,  0.1568,  0.0897],
        [-0.1094,  0.1392,  0.2812,  0.4332],
        [ 0.1565,  0.1035,  0.1493,  0.1609],
        [ 0.0066,  0.1693,  0.1504,  0.1693],
        [ 0.0899,  0.2035,  0.3656,  0.3422],
        [-0.0212,  0.1600,  0.2065,  0.1562],
        [ 0.0148,  0.1083,  0.2012,  0.1167],
        [-0.0189,  0.1688,  0.1931,  0.2668],
        [ 0.0462,  0.0507,  0.1945,  0.1507],
        [ 0.0617,  0.1208,  0.2899,  0.2533],
        [ 0.0595,  0.1688,  0.1391,  0.1807],
        [ 0.0808,  0.1306,  0.1982,  0.0231],
        [-0.0702,  0.2310,  0.2451,  0.2082],
        [ 0.0508,  0.2024,  0.2129,  0.2200],
        [-0.0215,  0.2159,  0.1538,  0.3255],
        [ 0.0744,  0.0831,  0.1817,  0.2149],
        [ 0.0284,  0.1374,  0.1849, -0.0983],
        [ 0.1096,  0.0902,  0.2109,  0.1929],
        [-0.0195,  0.1868,  0.1909,  0.2023],
        [ 0.0430,  0.1336,  0.0707,  0.1146],
        [ 0.1667,  0.0737,  0.1378,  0.1266],
        [ 0.1114,  0.0888,  0.1270,  0.0931],
        [-0.0198,  0.3242,  0.4151,  0.1754],
        [ 0.0129,  0.1743,  0.2405,  0.2185],
        [ 0.0240,  0.2410,  0.1809,  0.2100],
        [ 0.0374,  0.1393,  0.1990,  0.2544],
        [-0.0051,  0.1252,  0.2192,  0.1286],
        [-0.0285,  0.2445,  0.2172,  0.2336],
        [ 0.1052,  0.0502,  0.2211,  0.0962],
        [ 0.0843,  0.1835,  0.1411,  0.0962],
        [ 0.0573,  0.2140,  0.1733,  0.1948],
        [ 0.0916,  0.1132,  0.1956,  0.1698],
        [ 0.0996,  0.1588,  0.1463,  0.1200],
        [ 0.0102,  0.1796,  0.1374,  0.1590],
        [ 0.1500,  0.1267,  0.2341,  0.2268],
        [ 0.1071,  0.0636,  0.1151,  0.1227],
        [ 0.0720,  0.1886,  0.1409,  0.1738],
        [ 0.0552,  0.0699,  0.2703,  0.0562],
        [ 0.1261,  0.1067,  0.1656,  0.1929],
        [-0.0234,  0.1219,  0.2296,  0.2552],
        [ 0.0230,  0.2554,  0.2132,  0.1263],
        [ 0.1184,  0.1480,  0.1776,  0.1870],
        [ 0.0977,  0.1429,  0.1374,  0.1594],
        [ 0.0475,  0.1111,  0.2123,  0.1292],
        [ 0.1156,  0.1273,  0.1325,  0.1133]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([0, 3, 2, 1, 1, 0, 1, 2, 3, 3, 1, 0, 0, 1, 2, 1, 0, 0, 0, 0, 3, 0, 1, 2,
        2, 0, 3, 2, 1, 1, 2, 3, 3, 3, 0, 1, 0, 3, 2, 0, 0, 3, 3, 3, 3, 1, 3, 0,
        2, 3, 0, 1, 1, 2, 0, 1, 2, 0, 3, 1, 0, 1, 0, 0], device='cuda:0')
100%|##########| 2/2 [00:00<00:00, 33.49it/s]
04-12 11:40:20 Train-Loss Source Classifier: 1.3630
04-12 11:40:20 Train-Loss Discriminator: 0.6783
04-12 11:40:20 Train-Acc Source Data: 0.3594
04-12 11:40:20 Train-Acc Discriminator: 50.0000
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 166.01it/s]
04-12 11:40:20 Val-Acc Target Data: 0.2719
04-12 11:40:20 The best model epoch 2, val-acc 0.2719
04-12 11:40:20 -----Epoch 3/30-----
04-12 11:40:20 current lr: [0.001, 0.001]
  0%|          | 0/2 [00:00<?, ?it/s]tensor([[ 0.1020,  0.2000,  0.1015,  0.0932],
        [ 0.1160,  0.1536,  0.1804,  0.1255],
        [ 0.0202,  0.2289,  0.1738,  0.2362],
        [ 0.0241,  0.1489,  0.1468,  0.3032],
        [-0.0445,  0.1435,  0.2117,  0.1646],
        [ 0.1063,  0.0740,  0.1603,  0.1343],
        [-0.0399,  0.1384,  0.3500,  0.2369],
        [ 0.0160,  0.2329,  0.1782,  0.1695],
        [ 0.0425,  0.2222,  0.1131,  0.1977],
        [ 0.2012,  0.0650,  0.2173,  0.1011],
        [-0.0152,  0.1591,  0.2060,  0.2649],
        [ 0.0902,  0.1195,  0.1413,  0.2059],
        [ 0.0228,  0.2315,  0.1500,  0.3222],
        [ 0.0424,  0.1177,  0.2618,  0.2492],
        [-0.0080,  0.1586,  0.2649,  0.2429],
        [ 0.0741,  0.1876,  0.1452,  0.2043],
        [ 0.0958,  0.1179,  0.1683,  0.1686],
        [ 0.1096,  0.0655,  0.1457,  0.1569],
        [ 0.1309,  0.2088,  0.1758,  0.0337],
        [ 0.2515,  0.1214,  0.3214,  0.2985],
        [ 0.0475,  0.1496,  0.2759,  0.2329],
        [-0.0367,  0.1687,  0.2596,  0.1914],
        [ 0.1639,  0.0264,  0.3528, -0.0811],
        [ 0.1002,  0.2157,  0.2285,  0.1322],
        [-0.0281,  0.1858,  0.0616,  0.1450],
        [-0.0246,  0.2424,  0.2373,  0.3375],
        [-0.0311,  0.2054,  0.0613,  0.1769],
        [-0.0239,  0.1126,  0.1519,  0.1914],
        [ 0.1106,  0.0917,  0.1245,  0.1227],
        [-0.0579,  0.1187,  0.1666,  0.1231],
        [ 0.0254,  0.1288,  0.1462,  0.2156],
        [ 0.0667,  0.1261,  0.2861,  0.3239],
        [-0.1716,  0.0475,  0.4024,  0.1311],
        [ 0.1200,  0.1150,  0.1548,  0.1466],
        [ 0.0348,  0.1347,  0.1379,  0.2555],
        [ 0.0071,  0.1128,  0.2265,  0.2520],
        [-0.0267,  0.1462,  0.2380,  0.2050],
        [ 0.0431,  0.1553,  0.2161,  0.2249],
        [ 0.1670,  0.0878,  0.1180,  0.1821],
        [-0.0420,  0.1926,  0.1017,  0.2721],
        [ 0.1212,  0.1198,  0.1680,  0.1182],
        [ 0.0451,  0.1620,  0.1811,  0.1900],
        [ 0.1656,  0.0342,  0.1578,  0.1304],
        [-0.0134,  0.1594,  0.0967,  0.1504],
        [-0.0782,  0.2397,  0.1778,  0.2512],
        [ 0.0041,  0.1323,  0.2104,  0.3356],
        [ 0.0253,  0.1428,  0.3941,  0.0317],
        [-0.0311,  0.2705,  0.1430,  0.2468],
        [-0.0072,  0.1197,  0.1968,  0.2288],
        [ 0.1186,  0.1949,  0.2202,  0.1241],
        [ 0.0128,  0.1686,  0.1984,  0.2067],
        [ 0.1132,  0.0456,  0.1382,  0.1676],
        [ 0.0956,  0.0883,  0.1323,  0.1394],
        [ 0.1280,  0.1202,  0.1954,  0.1442],
        [ 0.0192,  0.2548,  0.3212,  0.2234],
        [ 0.0821,  0.1606,  0.2207,  0.1525],
        [ 0.1288,  0.0878,  0.2345,  0.1124],
        [ 0.1509,  0.1075,  0.1845,  0.1357],
        [-0.0100,  0.1802,  0.1151,  0.1346],
        [ 0.0015,  0.2714,  0.1387,  0.1227],
        [-0.0220,  0.1597,  0.2464,  0.2813],
        [ 0.0206,  0.2012,  0.1895,  0.2725],
        [ 0.0084,  0.0833,  0.2023,  0.2347],
        [ 0.2373,  0.2392,  0.2842,  0.1227]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([2, 0, 1, 3, 1, 0, 3, 1, 1, 0, 3, 0, 3, 1, 3, 1, 0, 0, 2, 2, 3, 1, 1, 2,
        1, 2, 1, 3, 0, 1, 3, 3, 2, 0, 2, 2, 3, 2, 0, 3, 0, 1, 0, 1, 3, 2, 1, 3,
        3, 1, 2, 0, 0, 0, 2, 2, 0, 0, 1, 1, 3, 3, 3, 1], device='cuda:0')
tensor([[-0.0873,  0.1778,  0.1477,  0.2766],
        [ 0.0555,  0.0973,  0.4398,  0.2909],
        [ 0.0412,  0.1969,  0.2008,  0.1247],
        [-0.0132,  0.2153,  0.1828,  0.2204],
        [ 0.1690,  0.1708,  0.2024,  0.1938],
        [-0.0227,  0.1303,  0.1058,  0.2726],
        [ 0.0580,  0.0880,  0.1902,  0.3214],
        [ 0.1121,  0.0666,  0.1419,  0.1580],
        [ 0.1746,  0.0796,  0.1436,  0.1309],
        [ 0.1983,  0.0497,  0.0915,  0.1414],
        [ 0.0078,  0.1430,  0.1149,  0.1119],
        [ 0.0950,  0.1974,  0.1401,  0.2429],
        [ 0.0031,  0.1159,  0.1957,  0.1856],
        [ 0.0803,  0.1310,  0.1920,  0.1565],
        [ 0.0628,  0.2025,  0.2818,  0.2092],
        [ 0.0584,  0.2140,  0.1654,  0.1579],
        [ 0.0482,  0.1580,  0.1385,  0.3001],
        [ 0.0206,  0.1452,  0.1958,  0.1021],
        [ 0.0586,  0.1777,  0.2333,  0.1132],
        [ 0.0598,  0.1123,  0.2678,  0.4502],
        [ 0.0268,  0.2692,  0.1433,  0.0987],
        [ 0.0268,  0.0842,  0.2571,  0.4107],
        [ 0.0670,  0.2353,  0.1564,  0.2203],
        [ 0.1171, -0.0061,  0.1932,  0.1523],
        [ 0.1285,  0.1517,  0.1457,  0.0624],
        [-0.0349,  0.1364,  0.1473,  0.1793],
        [-0.0118,  0.1801,  0.1768,  0.2532],
        [ 0.1482,  0.0847,  0.1770,  0.0667],
        [ 0.1190,  0.3635,  0.4116,  0.3502],
        [ 0.0573,  0.2153,  0.2487,  0.3278],
        [-0.0158,  0.2221,  0.1157,  0.2152],
        [-0.0308,  0.0959,  0.1690,  0.2695],
        [ 0.0014,  0.1798,  0.1268,  0.1233],
        [-0.0138,  0.1684,  0.2793,  0.4714],
        [-0.1188,  0.0974,  0.1780,  0.2802],
        [ 0.0454,  0.1905,  0.2023,  0.1902],
        [-0.0615,  0.1287,  0.1192,  0.3092],
        [-0.0614,  0.1342,  0.0795,  0.2891],
        [ 0.1701,  0.1009,  0.1530,  0.1065],
        [ 0.1514,  0.0299,  0.2391,  0.1664],
        [ 0.1527,  0.0608,  0.1135,  0.1337],
        [ 0.0376,  0.2085,  0.0916,  0.1967],
        [-0.0963,  0.0736,  0.2165,  0.2841],
        [-0.0086,  0.2421,  0.1193,  0.1241],
        [ 0.0410,  0.1861,  0.1109,  0.2342],
        [-0.0059, -0.0063,  0.3250,  0.4831],
        [ 0.0493,  0.3041,  0.0579,  0.2807],
        [ 0.0308,  0.0939,  0.2302,  0.3468],
        [ 0.0967,  0.1741,  0.1041,  0.1445],
        [-0.1006,  0.1641,  0.1145,  0.3070],
        [ 0.2142,  0.1521,  0.2495,  0.1594],
        [ 0.0479,  0.1728,  0.1116,  0.1460],
        [-0.0242,  0.0893,  0.1609,  0.3198],
        [ 0.0415,  0.2518,  0.2632,  0.2237],
        [-0.0904,  0.2018,  0.2149,  0.2817],
        [ 0.3660, -0.2491,  0.2355,  0.0769],
        [ 0.0774,  0.1554,  0.2544,  0.1361],
        [ 0.1683,  0.1197,  0.1580,  0.1534],
        [ 0.0156,  0.2311,  0.0523,  0.2242],
        [ 0.1790,  0.1395,  0.1869,  0.0600],
        [ 0.1044,  0.0724,  0.0973,  0.1377],
        [ 0.1296,  0.0700,  0.1344,  0.1472],
        [-0.0158,  0.2233,  0.1867,  0.2120],
        [-0.0811,  0.1022,  0.1591,  0.2628]], device='cuda:0',
       grad_fn=<SplitBackward0>) tensor([3, 3, 1, 1, 0, 2, 2, 0, 0, 0, 1, 1, 1, 0, 1, 1, 2, 2, 2, 2, 1, 2, 1, 0,
        2, 2, 2, 0, 3, 3, 1, 3, 1, 2, 3, 1, 3, 3, 0, 0, 0, 2, 3, 1, 1, 2, 1, 2,
        1, 3, 1, 1, 2, 1, 3, 1, 1, 0, 1, 0, 0, 1, 1, 3], device='cuda:0')
100%|##########| 2/2 [00:00<00:00, 34.94it/s]
04-12 11:40:20 Train-Loss Source Classifier: 1.3396
04-12 11:40:20 Train-Loss Discriminator: 0.6777
04-12 11:40:20 Train-Acc Source Data: 0.4219
04-12 11:40:20 Train-Acc Discriminator: 50.0000
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 163.26it/s]
04-12 11:40:20 Val-Acc Target Data: 0.2719
04-12 11:40:20 The best model epoch 3, val-acc 0.2719
04-12 11:40:20 -----Epoch 4/30-----
04-12 11:40:20 current lr: [0.001, 0.001]
  0%|          | 0/2 [00:00<?, ?it/s]