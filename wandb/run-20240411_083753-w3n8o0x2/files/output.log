04-11 08:37:54 model_name: ACDANN
04-11 08:37:54 Domain: CWRU
04-11 08:37:54 source: CWRU_2
04-11 08:37:54 target: CWRU_0
04-11 08:37:54 data_dir: ./datasets
04-11 08:37:54 train_mode: single_source
04-11 08:37:54 cuda_device: 0
04-11 08:37:54 save_dir: ./ckpt
04-11 08:37:54 max_epoch: 30
04-11 08:37:54 batch_size: 64
04-11 08:37:54 num_workers: 4
04-11 08:37:54 signal_size: 2048
04-11 08:37:54 random_state: 2024
04-11 08:37:54 normlizetype: mean-std
04-11 08:37:54 opt: sgd
04-11 08:37:54 lr: 0.01
04-11 08:37:54 momentum: 0.9
04-11 08:37:54 betas: (0.9, 0.999)
04-11 08:37:54 weight_decay: 0.0005
04-11 08:37:54 lr_scheduler: stepLR
04-11 08:37:54 gamma: 0.2
04-11 08:37:54 steps: 10
04-11 08:37:54 tradeoff: ['exp', 'exp', 'exp']
04-11 08:37:54 dropout: 0.0
04-11 08:37:54 save: False
04-11 08:37:54 load_path: 
04-11 08:37:54 save_path: ./ckpt/ACDANN/single_source/[CWRU_2]To[CWRU_0]_0411-083754
04-11 08:37:54 Detect 4 classes: ['ball', 'inner', 'normal', 'outer']
04-11 08:37:54 using 1 / 1 gpus
Training data length: 757
Testing data length: 379
Source Data Distribution:04-11 08:37:57 Source set CWRU_2 number of samples 1044.
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     261 |
| 1            |     261 |
| 2            |     261 |
| 3            |     261 |
| Dataset Size |    1044 |
+--------------+---------+

Training data length: 759
Testing data length: 380
Target Data Distribution:
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |       8 |    87 |
| 1            |       8 |    87 |
| 2            |     174 |    87 |
| 3            |       8 |    87 |
| Dataset Size |     198 |   348 |
+--------------+---------+-------+
04-11 08:37:57 target training set number of samples 198.
04-11 08:37:57 target validation set number of samples 348.
04-11 08:37:57 -----Epoch 1/30-----
04-11 08:37:57 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 67%|######6   | 2/3 [00:00<00:00, 19.50it/s]100%|##########| 3/3 [00:00<00:00, 22.84it/s]
04-11 08:37:58 Train-Loss Source Classifier: 1.3293
04-11 08:37:58 Train-Loss Discriminator: 0.6903
04-11 08:37:58 Train-Acc Source Data: 0.3333
04-11 08:37:58 Train-Acc Discriminator: 0.6380
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 147.16it/s]
04-11 08:37:58 Val-Acc Target Data: 0.2719
04-11 08:37:58 The best model epoch 1, val-acc 0.2719
04-11 08:37:58 -----Epoch 2/30-----
04-11 08:37:58 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.70it/s]100%|##########| 3/3 [00:00<00:00,  7.00it/s]
04-11 08:37:58 Train-Loss Source Classifier: 1.0628
04-11 08:37:58 Train-Loss Discriminator: 0.6900
04-11 08:37:58 Train-Acc Source Data: 0.6302
04-11 08:37:58 Train-Acc Discriminator: 0.5365
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 126.28it/s]
04-11 08:37:59 Val-Acc Target Data: 0.2719
04-11 08:37:59 The best model epoch 2, val-acc 0.2719
04-11 08:37:59 -----Epoch 3/30-----
04-11 08:37:59 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.52it/s]100%|##########| 3/3 [00:00<00:00,  6.59it/s]
04-11 08:37:59 Train-Loss Source Classifier: 0.8165
04-11 08:37:59 Train-Loss Discriminator: 0.6178
04-11 08:37:59 Train-Acc Source Data: 0.6615
04-11 08:37:59 Train-Acc Discriminator: 0.8359
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 120.75it/s]
04-11 08:38:00 Val-Acc Target Data: 0.2875
04-11 08:38:00 The best model epoch 3, val-acc 0.2875
04-11 08:38:00 -----Epoch 4/30-----
04-11 08:38:00 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.69it/s]100%|##########| 3/3 [00:00<00:00,  7.06it/s]
04-11 08:38:00 Train-Loss Source Classifier: 0.6264
04-11 08:38:00 Train-Loss Discriminator: 0.5028
04-11 08:38:00 Train-Acc Source Data: 0.7188
04-11 08:38:00 Train-Acc Discriminator: 0.7969
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 121.42it/s]
04-11 08:38:00 Val-Acc Target Data: 0.5687
04-11 08:38:00 The best model epoch 4, val-acc 0.5687
04-11 08:38:00 -----Epoch 5/30-----
04-11 08:38:00 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.61it/s]100%|##########| 3/3 [00:00<00:00,  6.88it/s]
04-11 08:38:01 Train-Loss Source Classifier: 0.4008
04-11 08:38:01 Train-Loss Discriminator: 0.4538
04-11 08:38:01 Train-Acc Source Data: 0.8229
04-11 08:38:01 Train-Acc Discriminator: 0.7995
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 120.69it/s]
04-11 08:38:01 Val-Acc Target Data: 0.4688
04-11 08:38:01 The best model epoch 4, val-acc 0.5687
04-11 08:38:01 -----Epoch 6/30-----
04-11 08:38:01 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.65it/s] 67%|######6   | 2/3 [00:00<00:00,  2.65it/s]100%|##########| 3/3 [00:00<00:00,  3.82it/s]
04-11 08:38:02 Train-Loss Source Classifier: 0.3411
04-11 08:38:02 Train-Loss Discriminator: 0.3936
04-11 08:38:02 Train-Acc Source Data: 0.8750
04-11 08:38:02 Train-Acc Discriminator: 0.8438
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 109.27it/s]
04-11 08:38:02 Val-Acc Target Data: 0.6438
04-11 08:38:03 The best model epoch 6, val-acc 0.6438
04-11 08:38:03 -----Epoch 7/30-----
04-11 08:38:03 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.57it/s]100%|##########| 3/3 [00:00<00:00,  6.69it/s]
04-11 08:38:03 Train-Loss Source Classifier: 0.3781
04-11 08:38:03 Train-Loss Discriminator: 0.4410
04-11 08:38:03 Train-Acc Source Data: 0.9010
04-11 08:38:03 Train-Acc Discriminator: 0.7969
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 119.82it/s]
04-11 08:38:03 Val-Acc Target Data: 0.6594
04-11 08:38:03 The best model epoch 7, val-acc 0.6594
04-11 08:38:03 -----Epoch 8/30-----
04-11 08:38:03 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.60it/s]100%|##########| 3/3 [00:00<00:00,  6.79it/s]
04-11 08:38:04 Train-Loss Source Classifier: 0.4654
04-11 08:38:04 Train-Loss Discriminator: 0.3870
04-11 08:38:04 Train-Acc Source Data: 0.8333
04-11 08:38:04 Train-Acc Discriminator: 0.8438
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 107.43it/s]
04-11 08:38:04 Val-Acc Target Data: 0.7344
04-11 08:38:04 The best model epoch 8, val-acc 0.7344
04-11 08:38:04 -----Epoch 9/30-----
04-11 08:38:04 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.54it/s]100%|##########| 3/3 [00:00<00:00,  6.66it/s]
04-11 08:38:05 Train-Loss Source Classifier: 0.1759
04-11 08:38:05 Train-Loss Discriminator: 0.4453
04-11 08:38:05 Train-Acc Source Data: 0.9219
04-11 08:38:05 Train-Acc Discriminator: 0.7995
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 120.10it/s]
04-11 08:38:05 Val-Acc Target Data: 0.8063
04-11 08:38:05 The best model epoch 9, val-acc 0.8063
04-11 08:38:05 -----Epoch 10/30-----
04-11 08:38:05 current lr: [0.01, 0.01]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.53it/s]100%|##########| 3/3 [00:00<00:00,  6.65it/s]
04-11 08:38:06 Train-Loss Source Classifier: 0.1134
04-11 08:38:06 Train-Loss Discriminator: 0.4001
04-11 08:38:06 Train-Acc Source Data: 0.9635
04-11 08:38:06 Train-Acc Discriminator: 0.8177
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 137.67it/s]
04-11 08:38:06 Val-Acc Target Data: 0.9156
04-11 08:38:06 The best model epoch 10, val-acc 0.9156
04-11 08:38:06 -----Epoch 11/30-----
04-11 08:38:06 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.66it/s]100%|##########| 3/3 [00:00<00:00,  3.81it/s]100%|##########| 3/3 [00:00<00:00,  3.65it/s]
04-11 08:38:07 Train-Loss Source Classifier: 0.0254
04-11 08:38:07 Train-Loss Discriminator: 0.4222
04-11 08:38:07 Train-Acc Source Data: 1.0000
04-11 08:38:07 Train-Acc Discriminator: 0.8125
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 119.81it/s]
04-11 08:38:07 Val-Acc Target Data: 0.9812
04-11 08:38:07 The best model epoch 11, val-acc 0.9812
04-11 08:38:07 -----Epoch 12/30-----
04-11 08:38:07 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.61it/s]100%|##########| 3/3 [00:00<00:00,  6.76it/s]
04-11 08:38:08 Train-Loss Source Classifier: 0.0172
04-11 08:38:08 Train-Loss Discriminator: 0.4131
04-11 08:38:08 Train-Acc Source Data: 1.0000
04-11 08:38:08 Train-Acc Discriminator: 0.8073
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 132.17it/s]
04-11 08:38:08 Val-Acc Target Data: 1.0000
04-11 08:38:08 The best model epoch 12, val-acc 1.0000
04-11 08:38:08 -----Epoch 13/30-----
04-11 08:38:08 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.60it/s]100%|##########| 3/3 [00:00<00:00,  6.83it/s]
04-11 08:38:09 Train-Loss Source Classifier: 0.0156
04-11 08:38:09 Train-Loss Discriminator: 0.3698
04-11 08:38:09 Train-Acc Source Data: 1.0000
04-11 08:38:09 Train-Acc Discriminator: 0.8490
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 135.80it/s]
04-11 08:38:09 Val-Acc Target Data: 1.0000
04-11 08:38:09 The best model epoch 13, val-acc 1.0000
04-11 08:38:09 -----Epoch 14/30-----
04-11 08:38:09 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.51it/s]100%|##########| 3/3 [00:00<00:00,  6.55it/s]
04-11 08:38:09 Train-Loss Source Classifier: 0.0129
04-11 08:38:09 Train-Loss Discriminator: 0.3590
04-11 08:38:09 Train-Acc Source Data: 1.0000
04-11 08:38:09 Train-Acc Discriminator: 0.8464
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 104.30it/s]
04-11 08:38:10 Val-Acc Target Data: 1.0000
04-11 08:38:10 The best model epoch 14, val-acc 1.0000
04-11 08:38:10 -----Epoch 15/30-----
04-11 08:38:10 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.64it/s]100%|##########| 3/3 [00:00<00:00,  6.83it/s]
04-11 08:38:10 Train-Loss Source Classifier: 0.0216
04-11 08:38:10 Train-Loss Discriminator: 0.4704
04-11 08:38:10 Train-Acc Source Data: 1.0000
04-11 08:38:10 Train-Acc Discriminator: 0.7969
  0%|          | 0/5 [00:00<?, ?it/s]100%|##########| 5/5 [00:00<00:00, 124.95it/s]
04-11 08:38:11 Val-Acc Target Data: 1.0000
04-11 08:38:11 The best model epoch 15, val-acc 1.0000
04-11 08:38:11 -----Epoch 16/30-----
04-11 08:38:11 current lr: [0.002, 0.002]
  0%|          | 0/3 [00:00<?, ?it/s] 33%|###3      | 1/3 [00:00<00:00,  2.63it/s]100%|##########| 3/3 [00:00<00:00,  6.89it/s]
04-11 08:38:11 Train-Loss Source Classifier: 0.0190
04-11 08:38:11 Train-Loss Discriminator: 0.3820
04-11 08:38:11 Train-Acc Source Data: 1.0000
04-11 08:38:11 Train-Acc Discriminator: 0.8281
  0%|          | 0/5 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 234, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/usr/lib/python3.6/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/usr/local/lib/python3.6/dist-packages/torch/multiprocessing/reductions.py", line 347, in reduce_storage
    fd, size = storage._share_fd_()
RuntimeError: unable to open shared memory object </torch_32224_1> in read-write mode: File exists (17)
