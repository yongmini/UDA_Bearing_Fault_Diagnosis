04-14 07:43:25 imba: False
04-14 07:43:25 model_name: CORAL
04-14 07:43:25 Domain: CWRU
04-14 07:43:25 source: CWRU_1
04-14 07:43:25 target: CWRU_2
04-14 07:43:25 data_dir: ./datasets
04-14 07:43:25 train_mode: single_source
04-14 07:43:25 cuda_device: 0
04-14 07:43:25 save_dir: ./ckpt/CORAL/single_source
04-14 07:43:25 max_epoch: 30
04-14 07:43:25 batch_size: 32
04-14 07:43:25 num_workers: 0
04-14 07:43:25 signal_size: 2048
04-14 07:43:25 random_state: 75
04-14 07:43:25 normlizetype: mean-std
04-14 07:43:25 opt: sgd
04-14 07:43:25 lr: 0.001
04-14 07:43:25 momentum: 0.9
04-14 07:43:25 betas: (0.9, 0.999)
04-14 07:43:25 weight_decay: 0.0005
04-14 07:43:25 lr_scheduler: stepLR
04-14 07:43:25 gamma: 0.2
04-14 07:43:25 steps: 10
04-14 07:43:25 tradeoff: ['exp', 'exp', 'exp']
04-14 07:43:25 dropout: 0.0
04-14 07:43:25 save: False
04-14 07:43:25 load_path: 
04-14 07:43:25 tsne: False
04-14 07:43:25 save_path: ./ckpt/CORAL/single_source/[CWRU_1]To[CWRU_2]_0414-074325
04-14 07:43:25 Detect 4 classes: ['1normal', 'ball', 'inner', 'outer']
04-14 07:43:26 using 1 / 1 gpus
Training data length: 757
Testing data length: 379
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     261 |
| 1            |     261 |
| 2            |     261 |
| 3            |     261 |
| Dataset Size |    1044 |
+--------------+---------+
04-14 07:43:29 Source set CWRU_1 number of samples 1044.
Training data length: 757
Testing data length: 379
Target Data Distribution:
04-14 07:43:29 target training set number of samples 696.
04-14 07:43:29 target validation set number of samples 348.
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     174 |    87 |
| 1            |     174 |    87 |
| 2            |     174 |    87 |
| 3            |     174 |    87 |
| Dataset Size |     696 |   348 |
+--------------+---------+-------+
04-14 07:43:29 -----Epoch 1/30-----
04-14 07:43:29 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 14%|#4        | 3/21 [00:00<00:00, 29.72it/s] 38%|###8      | 8/21 [00:00<00:00, 38.07it/s] 57%|#####7    | 12/21 [00:00<00:00, 38.85it/s] 81%|########  | 17/21 [00:00<00:00, 39.90it/s]100%|##########| 21/21 [00:00<00:00, 39.48it/s]
04-14 07:43:29 Train-Loss Source Classifier: 1.2375
04-14 07:43:29 Train-Loss CORAL: 0.0806
04-14 07:43:29 Train-Acc Source Data: 0.5045
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 194.63it/s]
04-14 07:43:29 Val-Acc Target Data: 0.5469
04-14 07:43:29 The best model epoch 1, val-acc 0.5469
04-14 07:43:29 -----Epoch 2/30-----
04-14 07:43:29 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.74it/s] 48%|####7     | 10/21 [00:00<00:00, 46.61it/s] 71%|#######1  | 15/21 [00:00<00:00, 47.23it/s] 95%|#########5| 20/21 [00:00<00:00, 47.27it/s]100%|##########| 21/21 [00:00<00:00, 47.17it/s]
04-14 07:43:30 Train-Loss Source Classifier: 0.7773
04-14 07:43:30 Train-Loss CORAL: 0.0889
04-14 07:43:30 Train-Acc Source Data: 0.7440
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 196.37it/s]
04-14 07:43:30 Val-Acc Target Data: 0.8875
04-14 07:43:30 The best model epoch 2, val-acc 0.8875
04-14 07:43:30 -----Epoch 3/30-----
04-14 07:43:30 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.18it/s] 48%|####7     | 10/21 [00:00<00:00, 46.75it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.58it/s] 95%|#########5| 20/21 [00:00<00:00, 46.94it/s]100%|##########| 21/21 [00:00<00:00, 46.97it/s]
04-14 07:43:30 Train-Loss Source Classifier: 0.3944
04-14 07:43:30 Train-Loss CORAL: 0.1070
04-14 07:43:30 Train-Acc Source Data: 0.9390
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 188.66it/s]
04-14 07:43:30 Val-Acc Target Data: 0.9812
04-14 07:43:30 The best model epoch 3, val-acc 0.9812
04-14 07:43:30 -----Epoch 4/30-----
04-14 07:43:30 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.76it/s] 48%|####7     | 10/21 [00:00<00:00, 47.20it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.91it/s] 95%|#########5| 20/21 [00:00<00:00, 46.72it/s]100%|##########| 21/21 [00:00<00:00, 46.90it/s]
04-14 07:43:31 Train-Loss Source Classifier: 0.1302
04-14 07:43:31 Train-Loss CORAL: 0.1031
04-14 07:43:31 Train-Acc Source Data: 0.9985
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 197.64it/s]
04-14 07:43:31 Val-Acc Target Data: 0.9969
04-14 07:43:31 The best model epoch 4, val-acc 0.9969
04-14 07:43:31 -----Epoch 5/30-----
04-14 07:43:31 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 48.45it/s] 48%|####7     | 10/21 [00:00<00:00, 48.20it/s] 71%|#######1  | 15/21 [00:00<00:00, 47.58it/s] 95%|#########5| 20/21 [00:00<00:00, 47.56it/s]100%|##########| 21/21 [00:00<00:00, 47.45it/s]
04-14 07:43:31 Train-Loss Source Classifier: 0.0567
04-14 07:43:31 Train-Loss CORAL: 0.1037
04-14 07:43:31 Train-Acc Source Data: 0.9940
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 182.90it/s]
04-14 07:43:31 Val-Acc Target Data: 0.9969
04-14 07:43:31 The best model epoch 5, val-acc 0.9969
04-14 07:43:31 -----Epoch 6/30-----
04-14 07:43:31 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 46.26it/s] 48%|####7     | 10/21 [00:00<00:00, 45.67it/s] 71%|#######1  | 15/21 [00:00<00:00, 45.95it/s] 95%|#########5| 20/21 [00:00<00:00, 46.46it/s]100%|##########| 21/21 [00:00<00:00, 46.35it/s]
04-14 07:43:32 Train-Loss Source Classifier: 0.0326
04-14 07:43:32 Train-Loss CORAL: 0.1029
04-14 07:43:32 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 195.06it/s]
04-14 07:43:32 Val-Acc Target Data: 1.0000
04-14 07:43:32 The best model epoch 6, val-acc 1.0000
04-14 07:43:32 -----Epoch 7/30-----
04-14 07:43:32 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 48.39it/s] 48%|####7     | 10/21 [00:00<00:00, 46.49it/s] 71%|#######1  | 15/21 [00:00<00:00, 47.24it/s] 95%|#########5| 20/21 [00:00<00:00, 46.93it/s]100%|##########| 21/21 [00:00<00:00, 46.93it/s]
04-14 07:43:32 Train-Loss Source Classifier: 0.0220
04-14 07:43:32 Train-Loss CORAL: 0.0914
04-14 07:43:32 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 189.85it/s]
04-14 07:43:32 Val-Acc Target Data: 1.0000
04-14 07:43:32 The best model epoch 7, val-acc 1.0000
04-14 07:43:32 -----Epoch 8/30-----
04-14 07:43:32 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 49.60it/s] 48%|####7     | 10/21 [00:00<00:00, 48.90it/s] 71%|#######1  | 15/21 [00:00<00:00, 48.13it/s] 95%|#########5| 20/21 [00:00<00:00, 47.55it/s]100%|##########| 21/21 [00:00<00:00, 47.83it/s]
04-14 07:43:33 Train-Loss Source Classifier: 0.0153
04-14 07:43:33 Train-Loss CORAL: 0.0868
04-14 07:43:33 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 188.42it/s]
04-14 07:43:33 Val-Acc Target Data: 1.0000
04-14 07:43:33 The best model epoch 8, val-acc 1.0000
04-14 07:43:33 -----Epoch 9/30-----
04-14 07:43:33 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.24it/s] 48%|####7     | 10/21 [00:00<00:00, 47.27it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.05it/s] 95%|#########5| 20/21 [00:00<00:00, 46.08it/s]100%|##########| 21/21 [00:00<00:00, 46.40it/s]
04-14 07:43:33 Train-Loss Source Classifier: 0.0147
04-14 07:43:33 Train-Loss CORAL: 0.0733
04-14 07:43:33 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 193.97it/s]
04-14 07:43:33 Val-Acc Target Data: 1.0000
04-14 07:43:33 The best model epoch 9, val-acc 1.0000
04-14 07:43:33 -----Epoch 10/30-----
04-14 07:43:33 current lr: [0.001]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.99it/s] 48%|####7     | 10/21 [00:00<00:00, 47.10it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.62it/s] 95%|#########5| 20/21 [00:00<00:00, 46.45it/s]100%|##########| 21/21 [00:00<00:00, 46.45it/s]
04-14 07:43:34 Train-Loss Source Classifier: 0.0114
04-14 07:43:34 Train-Loss CORAL: 0.0708
04-14 07:43:34 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 196.41it/s]
04-14 07:43:34 Val-Acc Target Data: 1.0000
04-14 07:43:34 The best model epoch 10, val-acc 1.0000
04-14 07:43:34 -----Epoch 11/30-----
04-14 07:43:34 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 49.59it/s] 48%|####7     | 10/21 [00:00<00:00, 48.64it/s] 71%|#######1  | 15/21 [00:00<00:00, 48.14it/s] 95%|#########5| 20/21 [00:00<00:00, 47.57it/s]100%|##########| 21/21 [00:00<00:00, 48.02it/s]
04-14 07:43:34 Train-Loss Source Classifier: 0.0112
04-14 07:43:34 Train-Loss CORAL: 0.0723
04-14 07:43:34 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 200.18it/s]
04-14 07:43:34 Val-Acc Target Data: 1.0000
04-14 07:43:34 The best model epoch 11, val-acc 1.0000
04-14 07:43:34 -----Epoch 12/30-----
04-14 07:43:34 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 29%|##8       | 6/21 [00:00<00:00, 52.98it/s] 57%|#####7    | 12/21 [00:00<00:00, 51.29it/s] 86%|########5 | 18/21 [00:00<00:00, 50.03it/s]100%|##########| 21/21 [00:00<00:00, 49.57it/s]
04-14 07:43:35 Train-Loss Source Classifier: 0.0096
04-14 07:43:35 Train-Loss CORAL: 0.0747
04-14 07:43:35 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 196.72it/s]
04-14 07:43:35 Val-Acc Target Data: 1.0000
04-14 07:43:35 The best model epoch 12, val-acc 1.0000
04-14 07:43:35 -----Epoch 13/30-----
04-14 07:43:35 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 48.48it/s] 48%|####7     | 10/21 [00:00<00:00, 48.54it/s] 71%|#######1  | 15/21 [00:00<00:00, 47.00it/s] 95%|#########5| 20/21 [00:00<00:00, 47.09it/s]100%|##########| 21/21 [00:00<00:00, 47.29it/s]
04-14 07:43:35 Train-Loss Source Classifier: 0.0110
04-14 07:43:35 Train-Loss CORAL: 0.0672
04-14 07:43:35 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 166.85it/s]
04-14 07:43:35 Val-Acc Target Data: 1.0000
04-14 07:43:35 The best model epoch 13, val-acc 1.0000
04-14 07:43:35 -----Epoch 14/30-----
04-14 07:43:35 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 48.31it/s] 48%|####7     | 10/21 [00:00<00:00, 47.22it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.88it/s] 95%|#########5| 20/21 [00:00<00:00, 46.43it/s]100%|##########| 21/21 [00:00<00:00, 46.54it/s]
04-14 07:43:36 Train-Loss Source Classifier: 0.0092
04-14 07:43:36 Train-Loss CORAL: 0.0659
04-14 07:43:36 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 189.29it/s]
04-14 07:43:36 Val-Acc Target Data: 1.0000
04-14 07:43:36 The best model epoch 14, val-acc 1.0000
04-14 07:43:36 -----Epoch 15/30-----
04-14 07:43:36 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 47.34it/s] 48%|####7     | 10/21 [00:00<00:00, 47.05it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.36it/s] 95%|#########5| 20/21 [00:00<00:00, 46.29it/s]100%|##########| 21/21 [00:00<00:00, 46.82it/s]
04-14 07:43:36 Train-Loss Source Classifier: 0.0096
04-14 07:43:36 Train-Loss CORAL: 0.0641
04-14 07:43:36 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 191.75it/s]
04-14 07:43:36 Val-Acc Target Data: 1.0000
04-14 07:43:36 The best model epoch 15, val-acc 1.0000
04-14 07:43:36 -----Epoch 16/30-----
04-14 07:43:36 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 48.05it/s] 48%|####7     | 10/21 [00:00<00:00, 46.92it/s] 71%|#######1  | 15/21 [00:00<00:00, 46.94it/s] 95%|#########5| 20/21 [00:00<00:00, 46.63it/s]100%|##########| 21/21 [00:00<00:00, 46.84it/s]
04-14 07:43:37 Train-Loss Source Classifier: 0.0096
04-14 07:43:37 Train-Loss CORAL: 0.0654
04-14 07:43:37 Train-Acc Source Data: 1.0000
  0%|          | 0/10 [00:00<?, ?it/s]100%|##########| 10/10 [00:00<00:00, 198.67it/s]
04-14 07:43:37 Val-Acc Target Data: 1.0000
04-14 07:43:37 The best model epoch 16, val-acc 1.0000
04-14 07:43:37 -----Epoch 17/30-----
04-14 07:43:37 current lr: [0.0002]
  0%|          | 0/21 [00:00<?, ?it/s] 24%|##3       | 5/21 [00:00<00:00, 49.46it/s]