04-11 09:56:16 imba: True
04-11 09:56:16 model_name: CORAL
04-11 09:56:16 Domain: JNU
04-11 09:56:16 source: JNU_0
04-11 09:56:16 target: JNU_2
04-11 09:56:16 data_dir: ./datasets
04-11 09:56:16 train_mode: single_source
04-11 09:56:16 cuda_device: 0
04-11 09:56:16 save_dir: ./ckpt
04-11 09:56:16 max_epoch: 30
04-11 09:56:16 batch_size: 64
04-11 09:56:16 num_workers: 0
04-11 09:56:16 signal_size: 2048
04-11 09:56:16 random_state: 2024
04-11 09:56:16 normlizetype: mean-std
04-11 09:56:16 opt: sgd
04-11 09:56:16 lr: 0.01
04-11 09:56:16 momentum: 0.9
04-11 09:56:16 betas: (0.9, 0.999)
04-11 09:56:16 weight_decay: 0.0005
04-11 09:56:16 lr_scheduler: stepLR
04-11 09:56:16 gamma: 0.2
04-11 09:56:16 steps: 10
04-11 09:56:16 tradeoff: ['exp', 'exp', 'exp']
04-11 09:56:16 dropout: 0.0
04-11 09:56:16 save: False
04-11 09:56:16 load_path: 
04-11 09:56:16 save_path: ./ckpt/CORAL/single_source/[JNU_0]To[JNU_2]_0411-095616
04-11 09:56:16 Detect 4 classes: ['ball', 'inner', 'normal', 'outer']
04-11 09:56:16 using 1 / 1 gpus
Training data length: 1461
Testing data length: 732
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     365 |
| 1            |     365 |
| 2            |     365 |
| 3            |     365 |
| Dataset Size |    1460 |
+--------------+---------+
04-11 09:56:26 Source set JNU_0 number of samples 1460.
Training data length: 1461
Testing data length: 732
Target Data Distribution:
04-11 09:56:34 target training set number of samples 249.
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |       2 |   122 |
| 1            |       2 |   122 |
| 2            |     243 |   122 |
| 3            |       2 |   122 |
| Dataset Size |     249 |   488 |
+--------------+---------+-------+
04-11 09:56:34 target validation set number of samples 488.
04-11 09:56:34 -----Epoch 1/30-----
04-11 09:56:34 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 25.19it/s]100%|##########| 3/3 [00:00<00:00, 25.15it/s]
04-11 09:56:34 Train-Loss Source Classifier: 1.3428
04-11 09:56:34 Train-Loss CORAL: 1.6485
04-11 09:56:34 Train-Acc Source Data: 0.2448
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 155.12it/s]
04-11 09:56:34 Val-Acc Target Data: 0.2723
04-11 09:56:34 The best model epoch 1, val-acc 0.2723
04-11 09:56:34 -----Epoch 2/30-----
04-11 09:56:34 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.32it/s]
04-11 09:56:34 Train-Loss Source Classifier: 1.3095
04-11 09:56:34 Train-Loss CORAL: 1.5059
04-11 09:56:34 Train-Acc Source Data: 0.2708
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 154.82it/s]
04-11 09:56:34 Val-Acc Target Data: 0.2679
04-11 09:56:34 The best model epoch 1, val-acc 0.2723
04-11 09:56:34 -----Epoch 3/30-----
04-11 09:56:34 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.72it/s]
04-11 09:56:34 Train-Loss Source Classifier: 1.1902
04-11 09:56:34 Train-Loss CORAL: 0.9202
04-11 09:56:34 Train-Acc Source Data: 0.4792
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 147.17it/s]
04-11 09:56:34 Val-Acc Target Data: 0.2455
04-11 09:56:34 The best model epoch 1, val-acc 0.2723
04-11 09:56:34 -----Epoch 4/30-----
04-11 09:56:34 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 35.14it/s]
04-11 09:56:34 Train-Loss Source Classifier: 1.1393
04-11 09:56:34 Train-Loss CORAL: 0.4041
04-11 09:56:34 Train-Acc Source Data: 0.5312
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 152.48it/s]
04-11 09:56:34 Val-Acc Target Data: 0.2545
04-11 09:56:34 The best model epoch 1, val-acc 0.2723
04-11 09:56:34 -----Epoch 5/30-----
04-11 09:56:34 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.39it/s]
04-11 09:56:34 Train-Loss Source Classifier: 1.0688
04-11 09:56:34 Train-Loss CORAL: 0.2296
04-11 09:56:34 Train-Acc Source Data: 0.5208
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 156.72it/s]
04-11 09:56:35 Val-Acc Target Data: 0.2723
04-11 09:56:35 The best model epoch 5, val-acc 0.2723
04-11 09:56:35 -----Epoch 6/30-----
04-11 09:56:35 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 36.06it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.9441
04-11 09:56:35 Train-Loss CORAL: 0.1606
04-11 09:56:35 Train-Acc Source Data: 0.5312
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 147.35it/s]
04-11 09:56:35 Val-Acc Target Data: 0.4018
04-11 09:56:35 The best model epoch 6, val-acc 0.4018
04-11 09:56:35 -----Epoch 7/30-----
04-11 09:56:35 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 36.95it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.9124
04-11 09:56:35 Train-Loss CORAL: 0.1244
04-11 09:56:35 Train-Acc Source Data: 0.5469
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 150.79it/s]
04-11 09:56:35 Val-Acc Target Data: 0.2768
04-11 09:56:35 The best model epoch 6, val-acc 0.4018
04-11 09:56:35 -----Epoch 8/30-----
04-11 09:56:35 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 35.99it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.9963
04-11 09:56:35 Train-Loss CORAL: 0.0918
04-11 09:56:35 Train-Acc Source Data: 0.5260
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 149.54it/s]
04-11 09:56:35 Val-Acc Target Data: 0.5402
04-11 09:56:35 The best model epoch 8, val-acc 0.5402
04-11 09:56:35 -----Epoch 9/30-----
04-11 09:56:35 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.66it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.8174
04-11 09:56:35 Train-Loss CORAL: 0.1083
04-11 09:56:35 Train-Acc Source Data: 0.6146
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 156.99it/s]
04-11 09:56:35 Val-Acc Target Data: 0.4040
04-11 09:56:35 The best model epoch 8, val-acc 0.5402
04-11 09:56:35 -----Epoch 10/30-----
04-11 09:56:35 current lr: [0.01]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 35.51it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.7166
04-11 09:56:35 Train-Loss CORAL: 0.0983
04-11 09:56:35 Train-Acc Source Data: 0.6771
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 148.34it/s]
04-11 09:56:35 Val-Acc Target Data: 0.4598
04-11 09:56:35 The best model epoch 8, val-acc 0.5402
04-11 09:56:35 -----Epoch 11/30-----
04-11 09:56:35 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 40.49it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.7007
04-11 09:56:35 Train-Loss CORAL: 0.0808
04-11 09:56:35 Train-Acc Source Data: 0.6250
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 157.76it/s]
04-11 09:56:35 Val-Acc Target Data: 0.7121
04-11 09:56:35 The best model epoch 11, val-acc 0.7121
04-11 09:56:35 -----Epoch 12/30-----
04-11 09:56:35 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 38.29it/s]
04-11 09:56:35 Train-Loss Source Classifier: 0.6891
04-11 09:56:35 Train-Loss CORAL: 0.0835
04-11 09:56:35 Train-Acc Source Data: 0.6771
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 153.01it/s]
04-11 09:56:35 Val-Acc Target Data: 0.5781
04-11 09:56:35 The best model epoch 11, val-acc 0.7121
04-11 09:56:35 -----Epoch 13/30-----
04-11 09:56:35 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 39.51it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.6601
04-11 09:56:36 Train-Loss CORAL: 0.0702
04-11 09:56:36 Train-Acc Source Data: 0.7396
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 161.31it/s]
04-11 09:56:36 Val-Acc Target Data: 0.7545
04-11 09:56:36 The best model epoch 13, val-acc 0.7545
04-11 09:56:36 -----Epoch 14/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 39.14it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.5968
04-11 09:56:36 Train-Loss CORAL: 0.0620
04-11 09:56:36 Train-Acc Source Data: 0.7448
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 160.88it/s]
04-11 09:56:36 Val-Acc Target Data: 0.7500
04-11 09:56:36 The best model epoch 13, val-acc 0.7545
04-11 09:56:36 -----Epoch 15/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.12it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.5602
04-11 09:56:36 Train-Loss CORAL: 0.0671
04-11 09:56:36 Train-Acc Source Data: 0.7448
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 152.62it/s]
04-11 09:56:36 Val-Acc Target Data: 0.7545
04-11 09:56:36 The best model epoch 15, val-acc 0.7545
04-11 09:56:36 -----Epoch 16/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 38.60it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.5248
04-11 09:56:36 Train-Loss CORAL: 0.0650
04-11 09:56:36 Train-Acc Source Data: 0.8438
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 159.66it/s]
04-11 09:56:36 Val-Acc Target Data: 0.6205
04-11 09:56:36 The best model epoch 15, val-acc 0.7545
04-11 09:56:36 -----Epoch 17/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 36.86it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.5181
04-11 09:56:36 Train-Loss CORAL: 0.0776
04-11 09:56:36 Train-Acc Source Data: 0.8021
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 152.56it/s]
04-11 09:56:36 Val-Acc Target Data: 0.6317
04-11 09:56:36 The best model epoch 15, val-acc 0.7545
04-11 09:56:36 -----Epoch 18/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 38.04it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.4396
04-11 09:56:36 Train-Loss CORAL: 0.0670
04-11 09:56:36 Train-Acc Source Data: 0.8542
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 150.78it/s]
04-11 09:56:36 Val-Acc Target Data: 0.7054
04-11 09:56:36 The best model epoch 15, val-acc 0.7545
04-11 09:56:36 -----Epoch 19/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 34.57it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.3737
04-11 09:56:36 Train-Loss CORAL: 0.0580
04-11 09:56:36 Train-Acc Source Data: 0.8906
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 153.46it/s]
04-11 09:56:36 Val-Acc Target Data: 0.7902
04-11 09:56:36 The best model epoch 19, val-acc 0.7902
04-11 09:56:36 -----Epoch 20/30-----
04-11 09:56:36 current lr: [0.002]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 39.21it/s]
04-11 09:56:36 Train-Loss Source Classifier: 0.4168
04-11 09:56:36 Train-Loss CORAL: 0.0567
04-11 09:56:36 Train-Acc Source Data: 0.8906
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 157.11it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6920
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 21/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 41.24it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.4589
04-11 09:56:37 Train-Loss CORAL: 0.0526
04-11 09:56:37 Train-Acc Source Data: 0.8490
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 158.01it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6317
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 22/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 36.56it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3445
04-11 09:56:37 Train-Loss CORAL: 0.0517
04-11 09:56:37 Train-Acc Source Data: 0.9115
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 156.09it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6272
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 23/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 40.20it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3784
04-11 09:56:37 Train-Loss CORAL: 0.0546
04-11 09:56:37 Train-Acc Source Data: 0.8854
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 155.51it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6339
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 24/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 37.69it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3541
04-11 09:56:37 Train-Loss CORAL: 0.0521
04-11 09:56:37 Train-Acc Source Data: 0.9115
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 147.59it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6317
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 25/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 35.85it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3661
04-11 09:56:37 Train-Loss CORAL: 0.0510
04-11 09:56:37 Train-Acc Source Data: 0.8958
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 154.79it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6295
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 26/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 41.60it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3511
04-11 09:56:37 Train-Loss CORAL: 0.0531
04-11 09:56:37 Train-Acc Source Data: 0.9062
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 145.59it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6250
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 27/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 39.42it/s]
04-11 09:56:37 Train-Loss Source Classifier: 0.3323
04-11 09:56:37 Train-Loss CORAL: 0.0571
04-11 09:56:37 Train-Acc Source Data: 0.9115
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 154.35it/s]
04-11 09:56:37 Val-Acc Target Data: 0.6295
04-11 09:56:37 The best model epoch 19, val-acc 0.7902
04-11 09:56:37 -----Epoch 28/30-----
04-11 09:56:37 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 40.51it/s]
04-11 09:56:38 Train-Loss Source Classifier: 0.3044
04-11 09:56:38 Train-Loss CORAL: 0.0611
04-11 09:56:38 Train-Acc Source Data: 0.9323
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 158.82it/s]
04-11 09:56:38 Val-Acc Target Data: 0.6473
04-11 09:56:38 The best model epoch 19, val-acc 0.7902
04-11 09:56:38 -----Epoch 29/30-----
04-11 09:56:38 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 36.74it/s]
04-11 09:56:38 Train-Loss Source Classifier: 0.3125
04-11 09:56:38 Train-Loss CORAL: 0.0553
04-11 09:56:38 Train-Acc Source Data: 0.9219
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 154.02it/s]
04-11 09:56:38 Val-Acc Target Data: 0.6518
04-11 09:56:38 The best model epoch 19, val-acc 0.7902
04-11 09:56:38 -----Epoch 30/30-----
04-11 09:56:38 current lr: [0.0004]
  0%|          | 0/3 [00:00<?, ?it/s]100%|##########| 3/3 [00:00<00:00, 38.58it/s]
04-11 09:56:38 Train-Loss Source Classifier: 0.3150
04-11 09:56:38 Train-Loss CORAL: 0.0541
04-11 09:56:38 Train-Acc Source Data: 0.9375
  0%|          | 0/7 [00:00<?, ?it/s]100%|##########| 7/7 [00:00<00:00, 160.65it/s]
04-11 09:56:38 Val-Acc Target Data: 0.6451
04-11 09:56:38 The best model epoch 19, val-acc 0.7902
