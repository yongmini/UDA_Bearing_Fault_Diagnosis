04-12 06:55:34 imba: False
04-12 06:55:34 model_name: DANN
04-12 06:55:34 Domain: CWRU
04-12 06:55:34 source: CWRU_1
04-12 06:55:34 target: CWRU_0
04-12 06:55:34 data_dir: ./datasets
04-12 06:55:34 train_mode: single_source
04-12 06:55:34 cuda_device: 0
04-12 06:55:34 save_dir: ./ckpt/DANN/single_source
04-12 06:55:34 max_epoch: 30
04-12 06:55:34 batch_size: 64
04-12 06:55:34 num_workers: 0
04-12 06:55:34 signal_size: 2048
04-12 06:55:34 random_state: 2024
04-12 06:55:34 normlizetype: mean-std
04-12 06:55:34 opt: sgd
04-12 06:55:34 lr: 0.001
04-12 06:55:34 momentum: 0.9
04-12 06:55:34 betas: (0.9, 0.999)
04-12 06:55:34 weight_decay: 0.0005
04-12 06:55:34 lr_scheduler: stepLR
04-12 06:55:34 gamma: 0.2
04-12 06:55:34 steps: 10
04-12 06:55:34 tradeoff: ['exp', 'exp', 'exp']
04-12 06:55:34 dropout: 0.0
04-12 06:55:34 save: False
04-12 06:55:34 load_path: 
04-12 06:55:34 tsne: True
04-12 06:55:34 save_path: ./ckpt/DANN/single_source/[CWRU_1]To[CWRU_0]_0412-065534
04-12 06:55:34 Detect 4 classes: ['ball', 'inner', 'normal', 'outer']
04-12 06:55:34 using 1 / 1 gpus
Training data length: 757
Testing data length: 379
Source Data Distribution:
04-12 06:55:37 Source set CWRU_1 number of samples 1044.
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |     261 |
| 1            |     261 |
| 2            |     261 |
| 3            |     261 |
| Dataset Size |    1044 |
+--------------+---------+
Training data length: 759
Testing data length: 380
Target Data Distribution:04-12 06:55:37 target training set number of samples 696.
04-12 06:55:37 target validation set number of samples 348.

+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     174 |    87 |
| 1            |     174 |    87 |
| 2            |     174 |    87 |
| 3            |     174 |    87 |
| Dataset Size |     696 |   348 |
+--------------+---------+-------+
04-12 06:55:37 -----Epoch 1/30-----
04-12 06:55:37 current lr: [0.001, 0.001]
11  0%|          | 0/11 [00:00<?, ?it/s]
 27%|##7       | 3/11 [00:00<00:00, 26.50it/s] 64%|######3   | 7/11 [00:00<00:00, 32.23it/s] 91%|######### | 10/11 [00:00<00:00, 29.33it/s]
Traceback (most recent call last):
  File "train.py", line 95, in <module>
    trainer.train()
  File "/home/workspace/UDA_Bearing_Fault_Diagnosis/models/DANN.py", line 96, in train
    loss_c = F.cross_entropy(y_s, source_labels)
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/functional.py", line 2962, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
ValueError: Expected input batch_size (60) to match target batch_size (64).
